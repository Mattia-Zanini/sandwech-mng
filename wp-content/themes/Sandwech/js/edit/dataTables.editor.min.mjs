import $ from"jquery";import DataTable from"datatables.net";var formOptions={buttons:!0,drawType:!1,focus:0,message:!0,nest:!1,onBackground:"blur",onBlur:"close",onComplete:"close",onEsc:"close",onFieldError:"focus",onReturn:"submit",scope:"row",submit:"all",submitHtml:"â–¶",submitTrigger:null,title:!0},defaults$1={actionName:"action",ajax:null,display:"lightbox",events:{},fields:[],formOptions:{bubble:$.extend({},formOptions,{buttons:"_basic",message:!1,submit:"changed",title:!1}),inline:$.extend({},formOptions,{buttons:!1,submit:"changed"}),main:$.extend({},formOptions)},i18n:{close:"Close",create:{button:"New",submit:"Create",title:"Create new entry"},datetime:{amPm:["am","pm"],hours:"Hour",minutes:"Minute",months:["January","February","March","April","May","June","July","August","September","October","November","December"],next:"Next",previous:"Previous",seconds:"Second",unknown:"-",weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},edit:{button:"Edit",submit:"Update",title:"Edit entry"},error:{system:'A system error has occurred (<a target="_blank" href="//datatables.net/tn/12">More information</a>).'},multi:{info:"The selected items contain different values for this input. To edit and set all items for this input to the same value, click or tap here, otherwise they will retain their individual values.",noMulti:"This input can be edited individually, but not part of a group.",restore:"Undo changes",title:"Multiple values"},remove:{button:"Delete",confirm:{1:"Are you sure you wish to delete 1 row?",_:"Are you sure you wish to delete %d rows?"},submit:"Delete",title:"Delete"}},idSrc:"DT_RowId",table:null},settings={action:null,actionName:"action",ajax:null,bubbleNodes:[],closeCb:null,closeIcb:null,dataSource:null,displayController:null,displayed:!1,editCount:0,editData:{},editFields:{},editOpts:{},fields:{},formOptions:{bubble:$.extend({},formOptions),inline:$.extend({},formOptions),main:$.extend({},formOptions)},globalError:"",id:-1,idSrc:null,includeFields:[],mode:null,modifier:null,opts:null,order:[],processing:!1,setFocus:null,table:null,template:null,unique:0},DataTable$6=$.fn.dataTable,DtInternalApi=DataTable$6.ext.oApi;function objectKeys(t){var e,i=[];for(e in t)t.hasOwnProperty(e)&&i.push(e);return i}function el(t,e){return void 0===e&&(e=document),$('*[data-dte-e="'+t+'"]',e)}function safeDomId(t,e){return void 0===e&&(e="#"),"string"==typeof t?e+t.replace(/\./g,"-"):e+t}function safeQueryId(t,e){return void 0===e&&(e="#"),"string"==typeof t?e+t.replace(/(:|\.|\[|\]|,)/g,"\\$1"):e+t}function dataGet(t){return DtInternalApi._fnGetObjectDataFn(t)}function dataSet(t){return DtInternalApi._fnSetObjectDataFn(t)}var extend=DtInternalApi._fnExtend;function pluck(t,i){var n=[];return $.each(t,function(t,e){n.push(e[i])}),n}function deepCompare(t,e){if("object"!=typeof t||"object"!=typeof e)return t==e;var i=objectKeys(t),n=objectKeys(e);if(i.length!==n.length)return!1;for(var o=0,s=i.length;o<s;o++){var a=i[o];if("object"==typeof t[a]){if(!deepCompare(t[a],e[a]))return!1}else if(t[a]!=e[a])return!1}return!0}var _dtIsSsp=function(t,e){return t.settings()[0].oFeatures.bServerSide&&"none"!==e.s.editOpts.drawType},_dtApi=function(t){return t instanceof $.fn.dataTable.Api?t:$(t).DataTable()},_dtHighlight=function(t){t=$(t),setTimeout(function(){t.addClass("highlight"),setTimeout(function(){t.addClass("noHighlight").removeClass("highlight"),setTimeout(function(){t.removeClass("noHighlight")},550)},500)},20)},_dtRowSelector=function(n,o,t,s,a){o.rows(t).indexes().each(function(t){var t=o.row(t),e=t.data(),i=a(e);void 0===i&&Editor.error("Unable to find row identifier",14),n[i]={data:e,fields:s,idSrc:i,node:t.node(),type:"row"}})},_dtFieldsFromIdx=function(t,e,i,n){function s(t,e){t.name()===e&&(o[t.name()]=t)}var t=t.settings()[0].aoColumns[i],a=void 0!==t.editField?t.editField:t.mData,o={};return $.each(e,function(t,e){if(Array.isArray(a))for(var i=0,n=a;i<n.length;i++){var o=n[i];s(e,o)}else s(e,a)}),$.isEmptyObject(o)&&!n&&Editor.error("Unable to automatically determine field from source. Please specify the field name.",11),o},_dtCellSelector=function(d,l,u,c,p,f){void 0===f&&(f=null);var h=l.cells(u);h.indexes().each(function(t){var e,i,n,o=l.cell(t),s=l.row(t.row).data(),s=p(s),a=f||_dtFieldsFromIdx(l,c,t.column,1<h.count()),r="object"==typeof u&&u.nodeName||u instanceof $;Object.keys(a).length&&(d[s]&&(i=d[s].attach,n=d[s].attachFields,e=d[s].displayFields),_dtRowSelector(d,l,t.row,c,p),d[s].attachFields=n||[],d[s].attachFields.push(Object.keys(a)),d[s].attach=i||[],d[s].attach.push(r?$(u).get(0):o.fixedNode?o.fixedNode():o.node()),d[s].displayFields=e||{},$.extend(d[s].displayFields,a))})},_dtColumnSelector=function(e,i,t,n,o){i.cells(null,t).indexes().each(function(t){_dtCellSelector(e,i,t,n,o)})},dataSource$1={commit:function(t,e,i,n){var o=this,s=_dtApi(this.s.table),a=s.settings()[0].oFeatures.bServerSide,r=n.rowIds;if(!_dtIsSsp(s,this)&&"edit"===t&&n.rowIds.length)for(var d=void 0,l=0,u=r.length;l<u;l++){try{d=s.row(safeQueryId(r[l]))}catch(t){d=s}(d=d.any()?d:s.row(function(n){return function(t,e,i){return n==dataSource$1.id.call(o,e)}}(r[l]))).any()&&!a&&d.remove()}t=this.s.editOpts.drawType;"none"!==t&&(n=s,a&&r&&r.length&&s.one("draw",function(){for(var t=0,e=r.length;t<e;t++){var i=s.row(safeQueryId(r[t]));i.any()&&_dtHighlight(i.node())}}),s.draw(t),n.responsive&&n.responsive.recalc(),"function"!=typeof n.searchPanes||a||n.searchPanes.rebuildPane(void 0,!0),void 0===n.searchBuilder||"function"!=typeof n.searchBuilder.rebuild||a||n.searchBuilder.rebuild(n.searchBuilder.getDetails()))},create:function(t,e){var i=_dtApi(this.s.table);_dtIsSsp(i,this)||(i=i.row.add(e),_dtHighlight(i.node()))},edit:function(t,e,i,n){var o=this,s=_dtApi(this.s.table);if(!_dtIsSsp(s,this)||"none"===this.s.editOpts.drawType){var a,r=dataSource$1.id.call(this,i),d=void 0;try{d=s.row(safeQueryId(r))}catch(t){d=s}(d=d.any()?d:s.row(function(t,e,i){return r==dataSource$1.id.call(o,e)})).any()?(a=extend({},d.data(),!0),a=extend(a,i,!0),d.data(a),a=$.inArray(r,n.rowIds),n.rowIds.splice(a,1)):d=s.row.add(i),_dtHighlight(d.node())}},fakeRow:function(t){for(var e=_dtApi(this.s.table),i=$('<tr class="dte-inlineAdd">'),n=[],o=[],s={},a=0,r=e.columns(":visible").count();a<r;a++){var d=e.column(a+":visible").index(),l=$("<td>").appendTo(i),u=_dtFieldsFromIdx(e,this.s.fields,d,!0),d=e.cell(":eq(0)",d).node();d&&l.addClass(d.className),Object.keys(u).length&&(n.push(Object.keys(u)),o.push(l[0]),$.extend(s,u))}function c(){i["end"===t?"appendTo":"prependTo"](e.table(void 0).body())}return this.__dtFakeRow=i,c(),e.on("draw.dte-createInline",function(){c()}),{0:{attach:o,attachFields:n,displayFields:s,fields:this.s.fields,type:"row"}}},fakeRowEnd:function(){_dtApi(this.s.table).off("draw.dte-createInline"),this.__dtFakeRow.remove(),this.__dtFakeRow=null},fields:function(t){var e=dataGet(this.s.idSrc),i=_dtApi(this.s.table),n=this.s.fields,o={};return!$.isPlainObject(t)||void 0===t.rows&&void 0===t.columns&&void 0===t.cells?_dtRowSelector(o,i,t,n,e):(void 0!==t.rows&&_dtRowSelector(o,i,t.rows,n,e),void 0!==t.columns&&_dtColumnSelector(o,i,t.columns,n,e),void 0!==t.cells&&_dtCellSelector(o,i,t.cells,n,e)),o},id:function(t){return dataGet(this.s.idSrc)(t)},individual:function(t,e){var i,n=dataGet(this.s.idSrc),o=_dtApi(this.s.table),s=this.s.fields,a={};return e&&(Array.isArray(e)||(e=[e]),i={},$.each(e,function(t,e){i[e]=s[e]})),_dtCellSelector(a,o,t,s,n,i),a},prep:function(t,e,i,n,o){var s,a=this;"create"===t&&(o.rowIds=$.map(n.data,function(t){return dataSource$1.id.call(a,t)})),"edit"===t?(s=n.cancelled||[],o.rowIds=$.map(i.data,function(t,e){return $.isEmptyObject(i.data[e])||-1!==$.inArray(e,s)?void 0:e})):"remove"===t&&(o.cancelled=n.cancelled||[])},refresh:function(){_dtApi(this.s.table).ajax.reload(null,!1)},remove:function(t,e,i){var n,o=this,s=_dtApi(this.s.table),a=i.cancelled;(0===a.length?s.rows(t):(n=[],s.rows(t).every(function(){var t=dataSource$1.id.call(o,this.data());-1===$.inArray(t,a)&&n.push(this.index())}),s.rows(n))).remove()}};function _htmlId(t){if("keyless"===t)return $(document);var e=$('[data-editor-id="'+t+'"]');if(0===(e=0===e.length?$("string"==typeof t?safeQueryId(t):t):e).length)throw new Error("Could not find an element with `data-editor-id` or `id` of: "+t);return e}function _htmlEl(t,e){t=_htmlId(t);return $('[data-editor-field="'+e+'"]',t)}function _htmlEls(t,e){for(var i=$(),n=0,o=e.length;n<o;n++)i=i.add(_htmlEl(t,e[n]));return i}function _htmlGet(t,e){t=_htmlEl(t,e);return t.filter("[data-editor-value]").length?t.attr("data-editor-value"):t.html()}function _htmlSet(n,t,o){$.each(t,function(t,e){var i=e.valFromData(o);void 0!==i&&((e=_htmlEl(n,e.dataSrc())).filter("[data-editor-value]").length?e.attr("data-editor-value",i):e.each(function(){for(;this.childNodes.length;)this.removeChild(this.firstChild)}).html(i))})}var dataSource={create:function(t,e){if(e){var i=dataSource.id.call(this,e);try{_htmlId(i).length&&_htmlSet(i,t,e)}catch(t){}}},edit:function(t,e,i){_htmlSet(dataSource.id.call(this,i)||"keyless",e,i)},fields:function(n){var t={};if(Array.isArray(n))for(var e=0,i=n.length;e<i;e++){var o=dataSource.fields.call(this,n[e]);t[n[e]]=o[n[e]]}else{var s={},a=this.s.fields;n=n||"keyless",$.each(a,function(t,e){var i=_htmlGet(n,e.dataSrc());e.valToData(s,null===i?void 0:i)}),t[n]={data:s,fields:a,idSrc:n,node:document,type:"row"}}return t},id:function(t){return dataGet(this.s.idSrc)(t)},individual:function(i,n){var o,t,s,a;if((i instanceof $||i.nodeName)&&(o=i,n=n||[$(i).attr("data-editor-field")],t=$.fn.addBack?"addBack":"andSelf",i=$(i).parents("[data-editor-id]")[t]().data("editor-id")),i=i||"keyless",(n=n&&!Array.isArray(n)?[n]:n)&&0!==n.length)return t=dataSource.fields.call(this,i),s=this.s.fields,a={},$.each(n,function(t,e){a[e]=s[e]}),$.each(t,function(t,e){e.type="cell",e.attachFields=[n],e.attach=o?$(o):_htmlEls(i,n).toArray(),e.fields=s,e.displayFields=a}),t;throw new Error("Cannot automatically determine field name from data source")},initField:function(t){var e=$('[data-editor-label="'+(t.data||t.name)+'"]');!t.label&&e.length&&(t.label=e.html())},remove:function(t,e){_htmlId(t).remove()}},classNames={actions:{create:"DTE_Action_Create",edit:"DTE_Action_Edit",remove:"DTE_Action_Remove"},body:{content:"DTE_Body_Content",wrapper:"DTE_Body"},bubble:{bg:"DTE_Bubble_Background",close:"icon close",liner:"DTE_Bubble_Liner",pointer:"DTE_Bubble_Triangle",table:"DTE_Bubble_Table",wrapper:"DTE DTE_Bubble"},field:{disabled:"disabled",error:"DTE_Field_StateError",input:"DTE_Field_Input",inputControl:"DTE_Field_InputControl",label:"DTE_Label","msg-error":"DTE_Field_Error","msg-info":"DTE_Field_Info","msg-label":"DTE_Label_Info","msg-message":"DTE_Field_Message",multiInfo:"multi-info",multiNoEdit:"multi-noEdit",multiRestore:"multi-restore",multiValue:"multi-value",namePrefix:"DTE_Field_Name_",processing:"DTE_Processing_Indicator",typePrefix:"DTE_Field_Type_",wrapper:"DTE_Field"},footer:{content:"DTE_Footer_Content",wrapper:"DTE_Footer"},form:{button:"btn",buttonInternal:"btn",buttons:"DTE_Form_Buttons",content:"DTE_Form_Content",error:"DTE_Form_Error",info:"DTE_Form_Info",tag:"",wrapper:"DTE_Form"},header:{content:"DTE_Header_Content",wrapper:"DTE_Header"},inline:{buttons:"DTE_Inline_Buttons",liner:"DTE_Inline_Field",wrapper:"DTE DTE_Inline"},processing:{active:"processing",indicator:"DTE_Processing_Indicator"},wrapper:"DTE"},displayed$2=!1,cssBackgroundOpacity=1,dom$1={background:$('<div class="DTED_Envelope_Background"><div></div></div>')[0],close:$('<div class="DTED_Envelope_Close"></div>')[0],content:null,wrapper:$('<div class="DTED DTED_Envelope_Wrapper"><div class="DTED_Envelope_Shadow"></div><div class="DTED_Envelope_Container"></div></div>')[0]};function findAttachRow(t,e){var i=new $.fn.dataTable.Api(t.s.table);return"head"===e||"create"===t.s.action?i.table(void 0).header():i.row(t.s.modifier).node()}function heightCalc$1(t){var e=$("div.DTE_Header",dom$1.wrapper).outerHeight(),i=$("div.DTE_Footer",dom$1.wrapper).outerHeight(),e=$(window).height()-2*envelope.conf.windowPadding-e-i;return $("div.DTE_Body_Content",dom$1.wrapper).css("maxHeight",e),$(t.dom.wrapper).outerHeight()}function hide$2(t,e){e=e||function(){},displayed$2&&($(dom$1.content).animate({top:-(dom$1.content.offsetHeight+50)},600,function(){$([dom$1.wrapper,dom$1.background]).fadeOut("normal",function(){$(this).detach(),e()})}),displayed$2=!1)}function init$1(){dom$1.content=$("div.DTED_Envelope_Container",dom$1.wrapper)[0],cssBackgroundOpacity=$(dom$1.background).css("opacity")}function show$2(e,t){var i,n,o,s;t=t||function(){},$("body").append(dom$1.background).append(dom$1.wrapper),dom$1.content.style.height="auto",displayed$2||((i=dom$1.wrapper.style).opacity="0",i.display="block",n=heightCalc$1(e),s=(o=findAttachRow(e,envelope.conf.attach)).offsetWidth,i.display="none",i.opacity="1",dom$1.wrapper.style.width=s+"px",dom$1.wrapper.style.marginLeft=-s/2+"px",dom$1.wrapper.style.top=$(o).offset().top+o.offsetHeight+"px",dom$1.content.style.top=-1*n-20+"px",dom$1.background.style.opacity="0",dom$1.background.style.display="block",$(dom$1.background).animate({opacity:cssBackgroundOpacity},"normal"),$(dom$1.wrapper).fadeIn(),$(dom$1.content).animate({top:0},600,t)),$(dom$1.close).attr("title",e.i18n.close).off("click.DTED_Envelope").on("click.DTED_Envelope",function(t){e.close()}),$(dom$1.background).off("click.DTED_Envelope").on("click.DTED_Envelope",function(t){e.background()}),$("div.DTED_Lightbox_Content_Wrapper",dom$1.wrapper).off("click.DTED_Envelope").on("click.DTED_Envelope",function(t){$(t.target).hasClass("DTED_Envelope_Content_Wrapper")&&e.background()}),$(window).off("resize.DTED_Envelope").on("resize.DTED_Envelope",function(){heightCalc$1(e)}),displayed$2=!0}var envelope={close:function(t,e){hide$2(t,e)},conf:{attach:"row",windowPadding:50},destroy:function(t){hide$2()},init:function(t){return init$1(),envelope},node:function(t){return dom$1.wrapper[0]},open:function(t,e,i){$(dom$1.content).children().detach(),dom$1.content.appendChild(e),dom$1.content.appendChild(dom$1.close),show$2(t,i)}};function isMobile(){return void 0!==window.orientation&&window.outerWidth<=576}var displayed$1=!1,ready=!1,scrollTop=0,dom={background:$('<div class="DTED_Lightbox_Background"><div></div></div>'),close:$('<div class="DTED_Lightbox_Close"></div>'),content:null,wrapper:$('<div class="DTED DTED_Lightbox_Wrapper"><div class="DTED_Lightbox_Container"><div class="DTED_Lightbox_Content_Wrapper"><div class="DTED_Lightbox_Content"></div></div></div></div>')};function heightCalc(){var t=$("div.DTE_Header",dom.wrapper).outerHeight()+$("div.DTE_Footer",dom.wrapper).outerHeight();isMobile()?$("div.DTE_Body_Content",dom.wrapper).css("maxHeight","calc(100vh - "+t+"px)"):(t=$(window).height()-2*self.conf.windowPadding-t,$("div.DTE_Body_Content",dom.wrapper).css("maxHeight",t))}function hide$1(t,e){e=e||function(){},$("body").scrollTop(scrollTop),t._animate(dom.wrapper,{opacity:0,top:self.conf.offsetAni},function(){$(this).detach(),e()}),t._animate(dom.background,{opacity:0},function(){$(this).detach()}),displayed$1=!1,$(window).off("resize.DTED_Lightbox")}function init(){ready||(dom.content=$("div.DTED_Lightbox_Content",dom.wrapper),dom.wrapper.css("opacity",0),dom.background.css("opacity",0),ready=!0)}function show$1(e,t){isMobile()&&$("body").addClass("DTED_Lightbox_Mobile"),$("body").append(dom.background).append(dom.wrapper),heightCalc(),displayed$1||(displayed$1=!0,dom.content.css("height","auto"),dom.wrapper.css({top:-self.conf.offsetAni}),e._animate(dom.wrapper,{opacity:1,top:0},t),e._animate(dom.background,{opacity:1}),$(window).on("resize.DTED_Lightbox",function(){heightCalc()}),scrollTop=$("body").scrollTop()),dom.close.attr("title",e.i18n.close).off("click.DTED_Lightbox").on("click.DTED_Lightbox",function(t){e.close()}),dom.background.off("click.DTED_Lightbox").on("click.DTED_Lightbox",function(t){t.stopImmediatePropagation(),e.background()}),$("div.DTED_Lightbox_Content_Wrapper",dom.wrapper).off("click.DTED_Lightbox").on("click.DTED_Lightbox",function(t){$(t.target).hasClass("DTED_Lightbox_Content_Wrapper")&&(t.stopImmediatePropagation(),e.background())})}var self={close:function(t,e){hide$1(t,e)},conf:{offsetAni:25,windowPadding:25},destroy:function(t){displayed$1&&hide$1(t)},init:function(t){return init(),self},node:function(t){return dom.wrapper[0]},open:function(t,e,i){var n=dom.content;n.children().detach(),n.append(e).append(dom.close),show$1(t,i)}},DataTable$5=$.fn.dataTable;function add(t,e,i){if(void 0===i&&(i=!0),Array.isArray(t)){void 0!==e&&t.reverse();for(var n=0,o=t;n<o.length;n++){var s=o[n];this.add(s,e,!1)}this._displayReorder(this.order())}else{var a=t.name;if(void 0===a)throw new Error("Error adding field. The field requires a `name` option");if(this.s.fields[a])throw new Error("Error adding field '"+a+"'. A field already exists with this name");this._dataSource("initField",t);var r=new Editor.Field(t,this.classes.field,this);this.s.mode&&(t=this.s.editFields,r.multiReset(),$.each(t,function(t,e){var i;e.data&&(i=r.valFromData(e.data)),r.multiSet(t,void 0!==i?i:r.def())})),this.s.fields[a]=r,void 0===e?this.s.order.push(a):null===e?this.s.order.unshift(a):(t=$.inArray(e,this.s.order),this.s.order.splice(t+1,0,a)),!1!==i&&this._displayReorder(this.order())}return this}function ajax(t){return t?(this.s.ajax=t,this):this.s.ajax}function background(){var t=this.s.editOpts.onBackground;return"function"==typeof t?t(this):"blur"===t?this.blur():"close"===t?this.close():"submit"===t&&this.submit(),this}function blur(){return this._blur(),this}function bubble(t,e,r,d){var l,u=this,i=this;return this._tidy(function(){i.bubble(t,e,d)})||($.isPlainObject(e)?(d=e,r=!(e=void 0)):"boolean"==typeof e&&(r=e,d=e=void 0),$.isPlainObject(r)&&(d=r,r=!0),void 0===r&&(r=!0),d=$.extend({},this.s.formOptions.bubble,d),l=this._dataSource("individual",t,e),this._edit(t,l,"bubble",d,function(){var e=u._formOptions(d);if(!u._preopen("bubble"))return u;$(window).on("resize."+e,function(){u.bubblePosition()});var t=[],t=(u.s.bubbleNodes=t.concat.apply(t,pluck(l,"attach")),u.classes.bubble),i=$('<div class="'+t.bg+'"><div></div></div>'),n=$('<div class="'+t.wrapper+'"><div class="'+t.liner+'"><div class="'+t.table+'"><div class="'+t.close+'" title="'+u.i18n.close+'"></div><div class="DTE_Processing_Indicator"><span></div></div></div><div class="'+t.pointer+'"></div></div>'),t=(r&&(n.appendTo("body"),i.appendTo("body")),n.children().eq(0)),o=t.children(),s=o.children(),a=(t.append(u.dom.formError),o.prepend(u.dom.form),d.message&&t.prepend(u.dom.formInfo),d.title&&t.prepend(u.dom.header),d.buttons&&o.append(u.dom.buttons),$().add(n).add(i));u._closeReg(function(t){u._animate(a,{opacity:0},function(){this===n[0]&&(a.detach(),$(window).off("resize."+e),u._clearDynamicInfo(),u._event("closed",["bubble"]))})}),i.on("click",function(){u.blur()}),s.on("click",function(){u._close()}),u.bubblePosition(),u._postopen("bubble",!1);u._animate(a,{opacity:1},function(){this===n[0]&&(u._focus(u.s.includeFields,d.focus),u._event("opened",["bubble",u.s.action]))})})),this}function bubblePosition(){var t=$("div.DTE_Bubble"),e=$("div.DTE_Bubble_Liner"),i=this.s.bubbleNodes,n={bottom:0,left:0,right:0,top:0},i=($.each(i,function(t,e){var i=$(e).offset();e=$(e).get(0),n.top+=i.top,n.left+=i.left,n.right+=i.left+e.offsetWidth,n.bottom+=i.top+e.offsetHeight}),n.top/=i.length,n.left/=i.length,n.right/=i.length,n.bottom/=i.length,n.top),o=(n.left+n.right)/2,s=e.outerWidth(),a=o-s/2,s=a+s,r=$(window).width();return this.classes.bubble,t.css({left:o,top:i}),e.length&&e.offset().top<0?t.css("top",n.bottom).addClass("below"):t.removeClass("below"),r<s+15?e.css("left",a<15?-(a-15):-(15+(s-r))):e.css("left",a<15?-(a-15):0),this}function buttons(t){var s=this;return"_basic"===t?t=[{action:function(){this.submit()},text:this.i18n[this.s.action].submit}]:Array.isArray(t)||(t=[t]),$(this.dom.buttons).empty(),$.each(t,function(t,e){var i=(e="string"==typeof e?{action:function(){this.submit()},text:e}:e).text||e.label,n=e.action||e.fn,o=e.attr||{};$("<button></button>",{class:s.classes.form.button+(e.className?" "+e.className:"")}).html("function"==typeof i?i(s):i||"").attr("tabindex",void 0!==e.tabIndex?e.tabIndex:0).attr(o).on("keyup",function(t){13===t.which&&n&&n.call(s)}).on("keypress",function(t){13===t.which&&t.preventDefault()}).on("click",function(t){t.preventDefault(),n&&n.call(s,t)}).appendTo(s.dom.buttons)}),this}function clear(t){var i=this,e=this.s.fields;return"string"==typeof t?(i.field(t).destroy(),delete e[t],e=$.inArray(t,this.s.order),this.s.order.splice(e,1),-1!==(e=$.inArray(t,this.s.includeFields))&&this.s.includeFields.splice(e,1)):$.each(this._fieldNames(t),function(t,e){i.clear(e)}),this}function close(){return this._close(!1),this}function create(t,e,i,n){var o=this,s=this,a=this.s.fields,r=1;if(!this._tidy(function(){s.create(t,e,i,n)})){"number"==typeof t&&(r=t,t=e,e=i),this.s.editFields={};for(var d=0;d<r;d++)this.s.editFields[d]={fields:this.s.fields};var l=this._crudArgs(t,e,i,n);this.s.mode="main",this.s.action="create",this.s.modifier=null,this.dom.form.style.display="block",this._actionClass(),this._displayReorder(this.fields()),$.each(a,function(t,e){e.multiReset();for(var i=0;i<r;i++)e.multiSet(i,e.def());e.set(e.def())}),this._event("initCreate",null,function(){o._assembleMain(),o._formOptions(l.opts),l.maybeOpen()})}return this}function undependent(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;e++)this.undependent(t[e]);else $(this.field(t).node()).off(".edep");return this}function dependent(t,n,o){var s=this;if(Array.isArray(t))for(var e=0,i=t.length;e<i;e++)this.dependent(t[e],n,o);else{function a(n){o.preUpdate&&o.preUpdate(n),$.each({errors:"error",labels:"label",messages:"message",options:"update",values:"val"},function(t,i){n[t]&&$.each(n[t],function(t,e){r.field(t)[i](e)})}),$.each(["hide","show","enable","disable"],function(t,e){n[e]&&r[e](n[e],n.animate)}),o.postUpdate&&o.postUpdate(n),d.processing(!1)}var r=this,d=this.field(t),l={dataType:"json",type:"POST"};o=$.extend({data:null,event:"change",postUpdate:null,preUpdate:null},o);$(d.node()).on(o.event+".edep",function(t){var e,i;0!==$(d.node()).find(t.target).length&&(d.processing(!0),(e={}).rows=s.s.editFields?pluck(s.s.editFields,"data"):null,e.row=e.rows?e.rows[0]:null,e.values=s.val(),o.data&&(i=o.data(e))&&(o.data=i),"function"==typeof n?(i=n.call(s,d.val(),e,a,t))&&("object"==typeof i&&"function"==typeof i.then?i.then(function(t){t&&a(t)}):a(i)):($.isPlainObject(n)?$.extend(l,n):l.url=n,$.ajax($.extend(l,{data:e,success:a}))))})}return this}function destroy(){this.s.displayed&&this.close(),this.clear(),this.s.template&&$("body").append(this.s.template);var t=this.s.displayController;t.destroy&&t.destroy(this),$(document).off(".dte"+this.s.unique),this.dom=null,this.s=null}function disable(t){var i=this;return $.each(this._fieldNames(t),function(t,e){i.field(e).disable()}),this}function display(t){return void 0===t?this.s.displayed:this[t?"open":"close"]()}function displayed(){return $.map(this.s.fields,function(t,e){return t.displayed()?e:null})}function displayNode(){return this.s.displayController.node(this)}function edit(t,e,i,n,o){var s,a=this,r=this;return this._tidy(function(){r.edit(t,e,i,n,o)})||(s=this._crudArgs(e,i,n,o),this._edit(t,this._dataSource("fields",t),"main",s.opts,function(){a._assembleMain(),a._formOptions(s.opts),s.maybeOpen()})),this}function enable(t){var i=this;return $.each(this._fieldNames(t),function(t,e){i.field(e).enable()}),this}function error$1(t,e){var i=$(this.dom.wrapper);return void 0===e?(this._message(this.dom.formError,t,!0,function(){i.toggleClass("inFormError",void 0!==t&&""!==t)}),this.s.globalError=t):this.field(t).error(e),this}function field(t){var e=this.s.fields;if(e[t])return e[t];throw new Error("Unknown field name - "+t)}function fields(){return $.map(this.s.fields,function(t,e){return e})}function file(t,e){var i=this.files(t);if(i[e])return i[e];throw new Error("Unknown file id "+e+" in table "+t)}function files(t){if(!t)return Editor.files;var e=Editor.files[t];if(e)return e;throw new Error("Unknown file table name: "+t)}function get(t){var i,n=this;return t=t||this.fields(),Array.isArray(t)?(i={},$.each(t,function(t,e){i[e]=n.field(e).get()}),i):this.field(t).get()}function hide(t,i){var n=this;return $.each(this._fieldNames(t),function(t,e){n.field(e).hide(i)}),this}function ids(i){return void 0===i&&(i=!1),$.map(this.s.editFields,function(t,e){return!0===i?"#"+e:e})}function inError(t){if($(this.dom.formError),this.s.globalError)return!0;for(var e=this._fieldNames(t),i=0,n=e.length;i<n;i++)if(this.field(e[i]).inError())return!0;return!1}function inline(t,e,i){var n=this,o=this,s=($.isPlainObject(e)&&(i=e,e=void 0),i=$.extend({},this.s.formOptions.inline,i),this._dataSource("individual",t,e)),a=Object.keys(s);if(1<a.length)throw new Error("Cannot edit more than one row inline at a time");for(var r=[],d=0,l=s[a[0]].attach;d<l.length;d++){var u=l[d];r.push(u)}return $("div.DTE_Field",r).length||this._tidy(function(){o.inline(t,e,i)})||this._edit(t,s,"inline",i,function(){n._inline(s,i)}),this}function inlineCreate(t,e){var i=this;return $.isPlainObject(t)&&(e=t,t=null),this._tidy(function(){i.inlineCreate(t,e)})||($.each(this.s.fields,function(t,e){e.multiReset(),e.multiSet(0,e.def()),e.set(e.def())}),this.s.mode="main",this.s.action="create",this.s.modifier=null,this.s.editFields=this._dataSource("fakeRow",t),e=$.extend({},this.s.formOptions.inline,e),this._actionClass(),this._inline(this.s.editFields,e,function(){i._dataSource("fakeRowEnd")}),this._event("initCreate",null)),this}function message(t,e){return void 0===e?this._message(this.dom.formInfo,t):this.field(t).message(e),this}function mode(t){if(!t)return this.s.action;if(!this.s.action)throw new Error("Not currently in an editing mode");if("create"===this.s.action&&"create"!==t)throw new Error("Changing from create mode is not supported");return this.s.action=t,this}function modifier(){return this.s.modifier}function multiGet(t){var i,n=this;return void 0===t&&(t=this.fields()),Array.isArray(t)?(i={},$.each(t,function(t,e){i[e]=n.field(e).multiGet()}),i):this.field(t).multiGet()}function multiSet(t,e){var i=this;return $.isPlainObject(t)&&void 0===e?$.each(t,function(t,e){i.field(t).multiSet(e)}):this.field(t).multiSet(e),this}function node(t){var e=this;return t=t||this.order(),Array.isArray(t)?$.map(t,function(t){return e.field(t).node()}):this.field(t).node()}function off(t,e){return $(this).off(this._eventName(t),e),this}function on(t,e){return $(this).on(this._eventName(t),e),this}function one(t,e){return $(this).one(this._eventName(t),e),this}function open(){var e=this;return this._displayReorder(),this._closeReg(function(){e._nestedClose(function(){e._clearDynamicInfo(),e._event("closed",["main"])})}),this._preopen("main")&&(this._nestedOpen(function(){e._focus($.map(e.s.order,function(t){return e.s.fields[t]}),e.s.editOpts.focus),e._event("opened",["main",e.s.action])},this.s.editOpts.nest),this._postopen("main",!1)),this}function order(t){if(!t)return this.s.order;if(arguments.length&&!Array.isArray(t)&&(t=Array.prototype.slice.call(arguments)),this.s.order.slice().sort().join("-")!==t.slice().sort().join("-"))throw new Error("All fields, and no additional fields, must be provided for ordering.");return $.extend(this.s.order,t),this._displayReorder(),this}function remove(t,e,i,n,o){var s,a,r=this,d=this;return this._tidy(function(){d.remove(t,e,i,n,o)})||(void 0===t.length&&(t=[t]),s=this._crudArgs(e,i,n,o),a=this._dataSource("fields",t),this.s.action="remove",this.s.modifier=t,this.s.editFields=a,this.dom.form.style.display="none",this._actionClass(),this._event("initRemove",[pluck(a,"node"),pluck(a,"data"),t],function(){r._event("initMultiRemove",[a,t],function(){r._assembleMain(),r._formOptions(s.opts),s.maybeOpen();var t=r.s.editOpts;null!==t.focus&&$("button",r.dom.buttons).eq(t.focus).focus()})})),this}function set(t,e){var i,n=this;return $.isPlainObject(t)||((i={})[t]=e,t=i),$.each(t,function(t,e){n.field(t).set(e)}),this}function show(t,i){var n=this;return $.each(this._fieldNames(t),function(t,e){n.field(e).show(i)}),this}function submit(e,i,n,o){var s,a=this,r=this.s.fields,d=[],l=0,u=!1;return!this.s.processing&&this.s.action&&(this._processing(!0),s=function(){d.length!==l||u||a._event("initSubmit",[a.s.action],function(t){!1===t?a._processing(!1):(u=!0,a._submit(e,i,n,o))})},this.error(),$.each(r,function(t,e){e.inError()&&d.push(t)}),$.each(d,function(t,e){r[e].error("",function(){l++,s()})}),s()),this}function table(t){return void 0===t?this.s.table:(this.s.table=t,this)}function template(t){return void 0===t?this.s.template:(this.s.template=null===t?null:$(t),this)}function title(t){var e=$(this.dom.header).children("div."+this.classes.header.content);return void 0===t?e.html():("function"==typeof t&&(t=t(this,new DataTable$5.Api(this.s.table))),e.html(t),this)}function val(t,e){return void 0!==e||$.isPlainObject(t)?this.set(t,e):this.get(t)}function error(t,e,i){e=e?t+" For more information, please refer to https://datatables.net/tn/"+e:t;if(i=void 0===i?!0:i)throw e;console.warn(e)}function pairs(t,e,i){var n,o,s;if(e=$.extend({label:"label",value:"value"},e),Array.isArray(t))for(n=0,o=t.length;n<o;n++)s=t[n],$.isPlainObject(s)?i(void 0===s[e.value]?s[e.label]:s[e.value],s[e.label],n,s.attr):i(s,s,n);else n=0,$.each(t,function(t,e){i(e,t,n),n++})}function upload$1(s,a,r,d,l){var u=new FileReader,c=0,p=[],f="A server error occurred while uploading the file";s.error(a.name,""),"function"==typeof a.ajax?a.ajax(r,function(t){l.call(s,t)}):(d(a,a.fileReadText||"<i>Uploading file</i>"),u.onload=function(e){var i,n=new FormData;if(n.append("action","upload"),n.append("uploadField",a.name),n.append("upload",r[c]),a.ajaxData&&a.ajaxData(n,r[c],c),a.ajax?i=a.ajax:$.isPlainObject(s.s.ajax)?i=s.s.ajax.upload||s.s.ajax:"string"==typeof s.s.ajax&&(i=s.s.ajax),!i)throw new Error("No Ajax option specified for upload plug-in");if("function"==typeof(i="string"==typeof i?{url:i}:i).data){var t={},o=i.data(t);$.each(t=void 0!==o&&"string"!=typeof o?o:t,function(t,e){n.append(t,e)})}else if($.isPlainObject(i.data))throw new Error("Upload feature cannot use `ajax.data` with an object. Please use it as a function instead.");s._event("preUpload",[a.name,r[c],n],function(t){var o;!1===t?c<r.length-1?(c++,u.readAsDataURL(r[c])):l.call(s,p):(o=!1,s.on("preSubmit.DTE_Upload",function(){return!(o=!0)}),$.ajax($.extend({},i,{contentType:!1,data:n,dataType:"json",error:function(t){s.error(a.name,f),s._event("uploadXhrError",[a.name,t]),d(a)},processData:!1,success:function(t){if(s.off("preSubmit.DTE_Upload"),s._event("uploadXhrSuccess",[a.name,t]),t.fieldErrors&&t.fieldErrors.length)for(var e=t.fieldErrors,i=0,n=e.length;i<n;i++)s.error(e[i].name,e[i].status);else t.error?s.error(t.error):t.upload&&t.upload.id?(t.files&&$.each(t.files,function(t,e){Editor.files[t]||(Editor.files[t]={}),$.extend(Editor.files[t],e)}),p.push(t.upload.id),c<r.length-1?(c++,u.readAsDataURL(r[c])):(l.call(s,p),o&&s.submit())):s.error(a.name,f);d(a)},type:"post",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&(t.upload.onprogress=function(){var t;e.lengthComputable&&(t=(e.loaded/e.total*100).toFixed(0)+"%",d(a,1===r.length?t:c+":"+r.length+" "+t))},t.upload.onloadend=function(){d(a,a.processingText||"Processing")}),t}})))})},r=$.map(r,function(t){return t}),void 0!==a._limitLeft&&r.splice(a._limitLeft,r.length),u.readAsDataURL(r[0]))}var DataTable$4=$.fn.dataTable,_inlineCounter=0;function _actionClass(){var t=this.classes.actions,e=this.s.action,i=$(this.dom.wrapper);i.removeClass([t.create,t.edit,t.remove].join(" ")),"create"===e?i.addClass(t.create):"edit"===e?i.addClass(t.edit):"remove"===e&&i.addClass(t.remove)}function _ajax(i,n,o,t){var s,e,a=this.s.action,r={complete:[function(t,e){var i=null;if(204===t.status||"null"===t.responseText)i={};else try{i=t.responseJSON||JSON.parse(t.responseText)}catch(t){}$.isPlainObject(i)||Array.isArray(i)?n(i,400<=t.status,t):o(t,e,s)}],data:null,dataType:"json",error:[function(t,e,i){s=i}],success:[],type:"POST"},d=this.s.ajax,l="edit"===a||"remove"===a?pluck(this.s.editFields,"idSrc").join(","):null;"function"==typeof(d=$.isPlainObject(d)&&d[a]?d[a]:d)?d.call(this,null,null,i,n,o):("string"==typeof d?-1!==d.indexOf(" ")?(e=d.split(" "),r.type=e[0],r.url=e[1]):r.url=d:((e=$.extend({},d||{})).complete&&(r.complete.unshift(e.complete),delete e.complete),e.error&&(r.error.unshift(e.error),delete e.error),r=$.extend({},r,e)),r.replacements&&$.each(r.replacements,function(t,e){r.url=r.url.replace("{"+t+"}",e.call(this,t,l,a,i))}),r.url=r.url.replace(/_id_/,l).replace(/{id}/,l),r.data&&(e=(d="function"==typeof r.data)?r.data(i):r.data,i=d&&e?e:$.extend(!0,i,e)),r.data=i,"DELETE"!==r.type||void 0!==r.deleteBody&&!0!==r.deleteBody||(d=$.param(r.data),r.url+=-1===r.url.indexOf("?")?"?"+d:"&"+d,delete r.data),$.ajax(r))}function _animate(t,e,i,n){$.fn.animate?t.stop().animate(e,i,n):(t.css(e),"function"==typeof i?i.call(t):n&&n.call(t))}function _assembleMain(){var t=this.dom;$(t.wrapper).prepend(t.header),$(t.footer).append(t.formError).append(t.buttons),$(t.bodyContent).append(t.formInfo).append(t.form)}function _blur(){var t=this.s.editOpts.onBlur;!1!==this._event("preBlur")&&("function"==typeof t?t(this):"submit"===t?this.submit():"close"===t&&this._close())}function _clearDynamicInfo(i){var t,e;void 0===i&&(i=!1),this.s&&(t=this.classes.field.error,e=this.s.fields,$("div."+t,this.dom.wrapper).removeClass(t),$.each(e,function(t,e){e.error(""),i||e.message("")}),this.error(""),i||this.message(""))}function _close(t,e){var i;!1!==this._event("preClose")&&(this.s.closeCb&&(i=this.s.closeCb(t,e),this.s.closeCb=null),this.s.closeIcb&&(this.s.closeIcb(),this.s.closeIcb=null),$("body").off("focus.editor-focus"),this.s.displayed=!1,this._event("close"),i&&this._event("closed",[i]))}function _closeReg(t){this.s.closeCb=t}function _crudArgs(t,e,i,n){var o,s,a,r=this,t=$.isPlainObject(t)?t:"boolean"==typeof t?(a=t,e):(o=t,s=e,a=i,n);return void 0===a&&(a=!0),o&&r.title(o),s&&r.buttons(s),{maybeOpen:function(){a&&r.open()},opts:$.extend({},this.s.formOptions.main,t)}}function _dataSource(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=(this.s.table?Editor.dataSources.dataTable:Editor.dataSources.html)[t];if(n)return n.apply(this,e)}function _displayReorder(i){var n=this,o=$(this.dom.formContent),s=this.s.fields,t=this.s.order,a=this.s.template,r=this.s.mode||"main";i?this.s.includeFields=i:i=this.s.includeFields,o.children().detach(),$.each(t,function(t,e){-1!==n._weakInArray(e,i)&&(a&&"main"===r?(a.find('editor-field[name="'+e+'"]').after(s[e].node()),a.find('[data-editor-template="'+e+'"]')):o).append(s[e].node())}),a&&"main"===r&&a.appendTo(o),this._event("displayOrder",[this.s.displayed,this.s.action,o])}function _edit(t,e,i,a,n){for(var r,o=this,s=this.s.fields,d=[],l={},u=(this.s.editFields=e,this.s.editData=l,this.s.modifier=t,this.s.action="edit",this.dom.form.style.display="block",this.s.mode=i,this._actionClass(),$.each(s,function(o,s){s.multiReset(),r=!1,l[o]={},$.each(e,function(t,e){var i,n;e.fields[o]&&(i=s.valFromData(e.data),n=s.nullDefault(),l[o][t]=null===i?"":Array.isArray(i)?i.slice():i,a&&"row"!==a.scope?e.displayFields&&!e.displayFields[o]||(s.multiSet(t,void 0===i||n&&null===i?s.def():i,!1),r=!0):(s.multiSet(t,void 0===i||n&&null===i?s.def():i,!1),e.displayFields&&!e.displayFields[o]||(r=!0)))}),s._multiValueCheck(),0!==s.multiIds().length&&r&&d.push(o)}),this.order().slice()),c=u.length-1;0<=c;c--)-1===$.inArray(u[c].toString(),d)&&u.splice(c,1);this._displayReorder(u),this._event("initEdit",[pluck(e,"node")[0],pluck(e,"data")[0],t,i],function(){o._event("initMultiEdit",[e,t,i],function(){n()})})}function _event(t,e,i){var n;if(void 0===e&&(e=[]),void 0===i&&(i=void 0),!Array.isArray(t))return n=$.Event(t),$(this).triggerHandler(n,e),n=n.result,0===t.indexOf("pre")&&!1===n&&$(this).triggerHandler($.Event(t+"Cancelled"),e),i&&(n&&"object"==typeof n&&n.then?n.then(i):i(n)),n;for(var o=0,s=t.length;o<s;o++)this._event(t[o],e)}function _eventName(t){for(var e=t.split(" "),i=0,n=e.length;i<n;i++){var o,s=(o=e[i]).match(/^on([A-Z])/);s&&(o=s[1].toLowerCase()+o.substring(3)),e[i]=o}return e.join(" ")}function _fieldFromNode(i){var n=null;return $.each(this.s.fields,function(t,e){$(e.node()).find(i).length&&(n=e)}),n}function _fieldNames(t){return void 0===t?this.fields():Array.isArray(t)?t:[t]}function _focus(t,e){var i,n=this;"remove"!==this.s.action&&(t=$.map(t,function(t){return"string"==typeof t?n.s.fields[t]:t}),"number"==typeof e?i=t[e]:e?i=0===e.indexOf("jq:")?$("div.DTE "+e.replace(/^jq:/,"")):this.s.fields[e]:document.activeElement.blur(),(this.s.setFocus=i)&&i.focus())}function _formOptions(n){var o=this,s=this,t=_inlineCounter++,e=".dteInline"+t;return this.s.editOpts=n,this.s.editCount=t,"string"!=typeof n.title&&"function"!=typeof n.title||(this.title(n.title),n.title=!0),"string"!=typeof n.message&&"function"!=typeof n.message||(this.message(n.message),n.message=!0),"boolean"!=typeof n.buttons&&(this.buttons(n.buttons),n.buttons=!0),$(document).on("keydown"+e,function(t){var e,i;13===t.which&&o.s.displayed&&(e=$(document.activeElement))&&(i=o._fieldFromNode(e))&&"function"==typeof i.canReturnSubmit&&i.canReturnSubmit(e)&&t.preventDefault()}),$(document).on("keyup"+e,function(t){var e,i=$(document.activeElement);13===t.which&&o.s.displayed?(e=o._fieldFromNode(i))&&"function"==typeof e.canReturnSubmit&&e.canReturnSubmit(i)&&("submit"===n.onReturn?(t.preventDefault(),o.submit()):"function"==typeof n.onReturn&&(t.preventDefault(),n.onReturn(o,t))):27===t.which?(t.preventDefault(),"function"==typeof n.onEsc?n.onEsc(s,t):"blur"===n.onEsc?s.blur():"close"===n.onEsc?s.close():"submit"===n.onEsc&&s.submit()):i.parents(".DTE_Form_Buttons").length&&(37===t.which?i.prev("button").trigger("focus"):39===t.which&&i.next("button").trigger("focus"))}),this.s.closeIcb=function(){$(document).off("keydown"+e),$(document).off("keyup"+e)},e}function _inline(t,e,i){for(var n,r=this,o=(void 0===i&&(i=null),!1),s=this.classes.inline,a=t[Object.keys(t)[0]],d=null,l=[],u=0;u<a.attach.length;u++){var c=a.attachFields[u][0];l.push({field:this.s.fields[c],name:c,node:$(a.attach[u])})}var p=this._formOptions(e);if(!this._preopen("inline"))return this;for(var f=0,h=l;f<h.length;f++){var m=h[f],v=m.node,b=(m.children=v.contents().detach(),-1!==navigator.userAgent.indexOf("Edge/")?'style="width:'+v.width()+'px"':"");v.append($('<div class="'+s.wrapper+'"><div class="'+s.liner+'" '+b+'><div class="DTE_Processing_Indicator"><span></span></div></div><div class="'+s.buttons+'"></div></div>')),v.find("div."+s.liner.replace(/ /g,".")).append(m.field.node()).append(this.dom.formError),n=m.field.node(),e.buttons&&v.find("div."+s.buttons.replace(/ /g,".")).append(this.dom.buttons)}var _=e.submitTrigger;null!==_&&("number"==typeof _&&(t=$(n).closest("tr").children(),_=_<0?t[t.length+_]:t[_]),d=Array.prototype.slice.call($(_)[0].childNodes),$(d).detach(),$(_).on("click.dte-submit",function(t){t.stopImmediatePropagation(),r.submit()}).append(e.submitHtml)),this._closeReg(function(t,e){return o=!0,$(document).off("click"+p),t&&"edit"===e||l.forEach(function(t){t.node.contents().detach(),t.node.append(t.children)}),_&&$(_).off("click.dte-submit").empty().append(d),r._clearDynamicInfo(),i&&i(),"inline"}),setTimeout(function(){var s,a;o||(s=$.fn.addBack?"addBack":"andSelf",$(document).on("mousedown"+p,function(t){a=t.target}).on("keydown"+p,function(t){a=t.target}).on("click"+p,function(t){for(var e=!1,i=0,n=l;i<n.length;i++){var o=n[i];!o.field._typeFn("owns",a)&&-1===$.inArray(o.node[0],$(a).parents()[s]())||(e=!0)}e||r.blur()}))},0),this._focus($.map(l,function(t){return t.field}),e.focus),this._postopen("inline",!0)}function _optionsUpdate(n){var o=this;n.options&&$.each(this.s.fields,function(t,e){var i;void 0!==n.options[t]&&(i=o.field(t))&&i.update&&i.update(n.options[t])})}function _message(t,e,i,n){var o=!!$.fn.animate;void 0===i&&(i=!1),n=n||function(){},"function"==typeof e&&(e=e(this,new DataTable$4.Api(this.s.table))),t=$(t),o&&t.stop(),e?(n(),this.s.displayed&&o?t.html(e).fadeIn():t.html(e).css("display","block"),i&&t.attr("title",e)):(this.s.displayed&&o?t.fadeOut(function(){t.html(""),n()}):(t.html("").css("display","none"),n()),i&&t.removeAttr("title"))}function _multiInfo(){var t,e=this.s.fields,i=this.s.includeFields,n=!0;if(i)for(var o=0,s=i.length;o<s;o++){var a=e[i[o]],r=a.multiEditable();a.isMultiValue()&&r&&n?n=!(t=!0):t=!(!a.isMultiValue()||r),e[i[o]].multiInfoShown(t)}}function _nestedClose(t){var e,i=this.s.displayController._show;i&&i.length?1<i.length?(i.pop(),e=i[i.length-1],t&&t(),this.s.displayController.open(e.dte,e.append,e.callback)):(this.s.displayController.close(this,t),i.length=0):t&&t()}function _nestedOpen(t,e){var i=this.s.displayController;i._show||(i._show=[]),e||(i._show.length=0),i._show.push({append:this.dom.wrapper,callback:t,dte:this}),this.s.displayController.open(this,this.dom.wrapper,t)}function _postopen(t,e){var i=this,n=this.s.displayController.captureFocus;return void 0===n&&(n=!0),$(this.dom.form).off("submit.editor-internal").on("submit.editor-internal",function(t){t.preventDefault()}),!n||"main"!==t&&"bubble"!==t||$("body").on("focus.editor-focus",function(){0===$(document.activeElement).parents(".DTE").length&&0===$(document.activeElement).parents(".DTED").length&&i.s.setFocus&&i.s.setFocus.focus()}),this._multiInfo(),this._event("open",[t,this.s.action]),e&&this._event("opened",[t,this.s.action]),!0}function _preopen(t){return!1===this._event("preOpen",[t,this.s.action])?(this._clearDynamicInfo(),this._event("cancelOpen",[t,this.s.action]),"inline"!==this.s.mode&&"bubble"!==this.s.mode||!this.s.closeIcb||this.s.closeIcb(),this.s.closeIcb=null,!1):(this._clearDynamicInfo(!0),this.s.displayed=t,!0)}function _processing(t){var e=this.classes.processing.active;$(["div.DTE",this.dom.wrapper]).toggleClass(e,t),this.s.processing=t,this._event("processing",[t])}function _noProcessing(t){var i=!1;return $.each(this.s.fields,function(t,e){e.processing()&&(i=!0)}),i&&this.one("processing-field",function(){!0===this._noProcessing(t)&&this._submit.apply(this,t)}),!i}function _submit(n,o,t,s){var a,r=this,l=!1,e={},i={},u=dataSet,c=this.s.fields,d=this.s.editCount,p=this.s.editFields,f=this.s.editData,h=this.s.editOpts,m=h.submit;if(!1===this._noProcessing(arguments))Editor.error("Field is still processing",16,!1);else{var v=this.s.action,b={data:{}};if("create"===(b[this.s.actionName]=v)||"edit"===v)if($.each(p,function(s,a){var r={},d={};$.each(c,function(t,e){var i,n,o;a.fields[t]&&e.submittable()&&(o=e.multiGet(),i=u(t),void 0===o[s]?(n=e.valFromData(a.data),i(r,n)):(n=o[s],o=Array.isArray(n)&&"string"==typeof t&&-1!==t.indexOf("[]")?u(t.replace(/\[.*$/,"")+"-many-count"):null,i(r,n),o&&o(r,n.length),"edit"!==v||f[t]&&e.compare(n,f[t][s])||(i(d,n),l=!0,o&&o(d,n.length))))}),$.isEmptyObject(r)||(e[s]=r),$.isEmptyObject(d)||(i[s]=d)}),"create"===v||"all"===m||"allIfChanged"===m&&l)b.data=e;else{if("changed"!==m||!l)return this.s.action=null,"close"!==h.onComplete||void 0!==s&&!s?"function"==typeof h.onComplete&&h.onComplete(this):this._close(!1),n&&n.call(this),this._processing(!1),void this._event("submitComplete");b.data=i}else"remove"===v&&$.each(p,function(t,e){b.data[t]=e.data});a=$.extend(!0,{},b),t&&t(b),this._event("preSubmit",[b,v],function(t){!1===t?r._processing(!1):(r.s.ajax?r._ajax:r._submitTable).call(r,b,function(t,e,i){r._submitSuccess(t,e,b,a,r.s.action,d,s,n,o,i)},function(t,e,i){r._submitError(t,e,i,o,b,r.s.action)},b)})}}function _submitTable(t,e,i,n){var o,s=t.action,a={data:[]},r=dataGet(this.s.idSrc),d=dataSet(this.s.idSrc);"remove"!==s&&(o="main"===this.s.mode?this._dataSource("fields",this.modifier()):this._dataSource("individual",this.modifier()),$.each(t.data,function(t,e){var i,n=extend,n=(i="edit"===s?(i=n({},o[t].data,!0),n(i,e,!0)):n({},e,!0),r(i));d(i,"create"===s&&void 0===n?+new Date+t.toString():n),a.data.push(i)})),e(a)}function _submitSuccess(t,e,i,n,o,s,a,r,d,l){var u=this,c=this.s.fields,p=this.s.editOpts,f=this.s.modifier;if(this._event("postSubmit",[t,i,o,l]),t.error||(t.error=""),t.fieldErrors||(t.fieldErrors=[]),e||t.error||t.fieldErrors.length){var h=[];t.error&&h.push(t.error),$.each(t.fieldErrors,function(t,e){var i=c[e.name];if(!i)throw new Error("Unknown field: "+e.name);i.displayed()?(i.error(e.status||"Error"),0===t&&("focus"===p.onFieldError?(u._animate($(u.dom.bodyContent),{scrollTop:$(i.node()).position().top},500),i.focus()):"function"==typeof p.onFieldError&&p.onFieldError(u,e))):h.push(i.name()+": "+(e.status||"Error"))}),this.error(h.join("<br>")),this._event("submitUnsuccessful",[t]),d&&d.call(this,t)}else{var m={};if(!t.data||"create"!==o&&"edit"!==o)"remove"===o&&(this._dataSource("prep",o,f,n,t,m),this._event("preRemove",[t,this.ids()]),this._dataSource("remove",f,c,m),this._event(["remove","postRemove"],[t,this.ids()]),this._dataSource("commit",o,f,t.data,m));else{this._dataSource("prep",o,f,n,t,m);for(var v=0,b=t.data;v<b.length;v++){var _=b[v],y=_,g=this._dataSource("id",_);this._event("setData",[t,_,o]),"create"===o?(this._event("preCreate",[t,_,g]),this._dataSource("create",c,_,m),this._event(["create","postCreate"],[t,_,g])):"edit"===o&&(this._event("preEdit",[t,_,g]),this._dataSource("edit",f,c,_,m),this._event(["edit","postEdit"],[t,_,g]))}this._dataSource("commit",o,f,t.data,m)}s===this.s.editCount&&(i=this.s.action,this.s.action=null,"close"!==p.onComplete||void 0!==a&&!a?"function"==typeof p.onComplete&&p.onComplete(this):this._close(!!t.data,i)),r&&r.call(this,t),this._event("submitSuccess",[t,y,o])}this._processing(!1),this._event("submitComplete",[t,y,o])}function _submitError(t,e,i,n,o,s){this._event("postSubmit",[null,o,s,t]),this.error(this.i18n.error.system),this._processing(!1),n&&n.call(this,t,e,i),this._event(["submitError","submitComplete"],[t,e,i,o])}function _tidy(i){var n=this,o=this.s.table?new $.fn.dataTable.Api(this.s.table):null,s=!1;return o&&(s=o.settings()[0].oFeatures.bServerSide),this.s.processing?(this.one("submitComplete",function(){s?o.one("draw",i):setTimeout(function(){i()},10)}),!0):("inline"===this.display()||"bubble"===this.display())&&(this.one("close",function(){n.s.processing?n.one("submitComplete",function(t,e){s&&e?o.one("draw",i):setTimeout(function(){n.s&&i()},10)}):setTimeout(function(){n.s&&i()},10)}).blur(),!0)}function _weakInArray(t,e){for(var i=0,n=e.length;i<n;i++)if(t==e[i])return i;return-1}var fieldType={create:function(){},disable:function(){},enable:function(){},get:function(){},set:function(){}},DataTable$3=$.fn.dataTable;function _buttonText(t,e){null==e&&(e=t.uploadText||"Choose file..."),t._input.find("div.upload button").html(e)}function _commonUpload(e,i,n,t){var o,s=e.classes.form.buttonInternal,a=$('<div class="editor_upload"><div class="eu_table"><div class="row"><div class="cell upload limitHide"><button class="'+s+'"></button><input type="file" '+((t=void 0===t?!1:t)?"multiple":"")+'></input></div><div class="cell clearValue"><button class="'+s+'"></button></div></div><div class="row second"><div class="cell limitHide"><div class="drop"><span></span></div></div><div class="cell"><div class="rendered"></div></div></div></div></div>');return i._input=a,i._enabled=!0,i.id&&a.find("input[type=file]").attr("id",Editor.safeId(i.id)),i.attr&&a.find("input[type=file]").attr(i.attr),_buttonText(i),window.FileReader&&!1!==i.dragDrop?(a.find("div.drop span").text(i.dragDropText||"Drag and drop a file here to upload"),(o=a.find("div.drop")).on("drop",function(t){return i._enabled&&(Editor.upload(e,i,t.originalEvent.dataTransfer.files,_buttonText,n),o.removeClass("over")),!1}).on("dragleave dragexit",function(t){return i._enabled&&o.removeClass("over"),!1}).on("dragover",function(t){return i._enabled&&o.addClass("over"),!1}),e.on("open",function(){$("body").on("dragover.DTE_Upload drop.DTE_Upload",function(t){return!1})}).on("close",function(){$("body").off("dragover.DTE_Upload drop.DTE_Upload")})):(a.addClass("noDrop"),a.append(a.find("div.rendered"))),a.find("div.clearValue button").on("click",function(t){t.preventDefault(),i._enabled&&upload.set.call(e,i,"")}),a.find("input[type=file]").on("input",function(){Editor.upload(e,i,this.files,_buttonText,function(t){n.call(e,t),a.find("input[type=file]")[0].value=""})}),a}function _triggerChange(t){setTimeout(function(){t.trigger("change",{editor:!0,editorSet:!0})},0)}var baseFieldType=$.extend(!0,{},fieldType,{canReturnSubmit:function(t,e){return!0},disable:function(t){t._input.prop("disabled",!0)},enable:function(t){t._input.prop("disabled",!1)},get:function(t){return t._input.val()},set:function(t,e){t._input.val(e),_triggerChange(t._input)}}),hidden={create:function(t){return t._val=t.value,null},get:function(t){return t._val},set:function(t,e){t._val=e}},readonly=$.extend(!0,{},baseFieldType,{create:function(t){return t._input=$("<input/>").attr($.extend({id:Editor.safeId(t.id),readonly:"readonly",type:"text"},t.attr||{})),t._input[0]}}),text=$.extend(!0,{},baseFieldType,{create:function(t){return t._input=$("<input/>").attr($.extend({id:Editor.safeId(t.id),type:"text"},t.attr||{})),t._input[0]}}),password=$.extend(!0,{},baseFieldType,{create:function(t){return t._input=$("<input/>").attr($.extend({id:Editor.safeId(t.id),type:"password"},t.attr||{})),t._input[0]}}),textarea=$.extend(!0,{},baseFieldType,{canReturnSubmit:function(t,e){return!1},create:function(t){return t._input=$("<textarea></textarea>").attr($.extend({id:Editor.safeId(t.id)},t.attr||{})),t._input[0]}}),select=$.extend(!0,{},baseFieldType,{_addOptions:function(t,e,i){var n,o=t._input[0].options,s=0;(i=void 0===i?!1:i)?s=o.length:void(o.length=0)!==t.placeholder&&(i=void 0!==t.placeholderValue?t.placeholderValue:"",s+=1,o[0]=new Option(t.placeholder,i),n=void 0===t.placeholderDisabled||t.placeholderDisabled,o[0].hidden=n,o[0].disabled=n,o[0]._editor_val=i),e&&Editor.pairs(e,t.optionsPair,function(t,e,i,n){e=new Option(e,t);e._editor_val=t,n&&$(e).attr(n),o[i+s]=e})},create:function(i){return i._input=$("<select></select>").attr($.extend({id:Editor.safeId(i.id),multiple:!0===i.multiple},i.attr||{})).on("change.dte",function(t,e){e&&e.editor||(i._lastSet=select.get(i))}),select._addOptions(i,i.options||i.ipOpts),i._input[0]},destroy:function(t){t._input.off("change.dte")},get:function(t){var e=t._input.find("option:selected").map(function(){return this._editor_val}).toArray();return t.multiple?t.separator?e.join(t.separator):e:e.length?e[0]:null},set:function(t,e,i){i||(t._lastSet=e),t.multiple&&t.separator&&!Array.isArray(e)?e="string"==typeof e?e.split(t.separator):[]:Array.isArray(e)||(e=[e]);var n,o,s=e.length,a=!1,r=t._input.find("option");return t._input.find("option").each(function(){for(o=!1,n=0;n<s;n++)if(this._editor_val==e[n]){a=o=!0;break}this.selected=o}),t.placeholder&&!a&&!t.multiple&&r.length&&(r[0].selected=!0),i||_triggerChange(t._input),a},update:function(t,e,i){select._addOptions(t,e,i);e=t._lastSet;void 0!==e&&select.set(t,e,!0),_triggerChange(t._input)}}),checkbox=$.extend(!0,{},baseFieldType,{_addOptions:function(o,t,e){var s=o._input,a=0;(e=void 0===e?!1:e)?a=$("input",s).length:s.empty(),t&&Editor.pairs(t,o.optionsPair,function(t,e,i,n){s.append('<div><input id="'+Editor.safeId(o.id)+"_"+(i+a)+'" type="checkbox" /><label for="'+Editor.safeId(o.id)+"_"+(i+a)+'">'+e+"</label></div>"),$("input:last",s).attr("value",t)[0]._editor_val=t,n&&$("input:last",s).attr(n)})},create:function(t){return t._input=$("<div></div>"),checkbox._addOptions(t,t.options||t.ipOpts),t._input[0]},disable:function(t){t._input.find("input").prop("disabled",!0)},enable:function(t){t._input.find("input").prop("disabled",!1)},get:function(t){var e=[],i=t._input.find("input:checked");return i.length?i.each(function(){e.push(this._editor_val)}):void 0!==t.unselectedValue&&e.push(t.unselectedValue),void 0===t.separator||null===t.separator?e:e.join(t.separator)},set:function(t,e){var i,n,o=t._input.find("input"),s=(Array.isArray(e)||"string"!=typeof e?Array.isArray(e)||(e=[e]):e=e.split(t.separator||"|"),e.length);o.each(function(){for(n=!1,i=0;i<s;i++)if(this._editor_val==e[i]){n=!0;break}this.checked=n}),_triggerChange(o)},update:function(t,e,i){var n=checkbox.get(t);checkbox._addOptions(t,e,i),checkbox.set(t,n)}}),radio=$.extend(!0,{},baseFieldType,{_addOptions:function(o,t,e){var s=o._input,a=0;(e=void 0===e?!1:e)?a=$("input",s).length:s.empty(),t&&Editor.pairs(t,o.optionsPair,function(t,e,i,n){s.append('<div><input id="'+Editor.safeId(o.id)+"_"+(i+a)+'" type="radio" name="'+o.name+'" /><label for="'+Editor.safeId(o.id)+"_"+(i+a)+'">'+e+"</label></div>"),$("input:last",s).attr("value",t)[0]._editor_val=t,n&&$("input:last",s).attr(n)})},create:function(t){return t._input=$("<div />"),radio._addOptions(t,t.options||t.ipOpts),this.on("open",function(){t._input.find("input").each(function(){this._preChecked&&(this.checked=!0)})}),t._input[0]},disable:function(t){t._input.find("input").prop("disabled",!0)},enable:function(t){t._input.find("input").prop("disabled",!1)},get:function(t){var e=t._input.find("input:checked");return e.length?e[0]._editor_val:void 0!==t.unselectedValue?t.unselectedValue:void 0},set:function(t,e){t._input.find("input").each(function(){this._preChecked=!1,this._editor_val==e?(this.checked=!0,this._preChecked=!0):(this.checked=!1,this._preChecked=!1)}),_triggerChange(t._input.find("input:checked"))},update:function(t,e,i){var n=radio.get(t),e=(radio._addOptions(t,e,i),t._input.find("input"));radio.set(t,e.filter('[value="'+n+'"]').length?n:e.eq(0).attr("value"))}}),datetime=$.extend(!0,{},baseFieldType,{create:function(t){return t._input=$("<input />").attr($.extend(!0,{id:Editor.safeId(t.id),type:"text"},t.attr)),DataTable$3.DateTime||Editor.error("DateTime library is required",15),t._picker=new DataTable$3.DateTime(t._input,$.extend({format:t.displayFormat||t.format,i18n:this.i18n.datetime},t.opts)),!(t._closeFn=function(){t._picker.hide()})===t.keyInput&&t._input.on("keydown",function(t){t.preventDefault()}),this.on("close",t._closeFn),t._input[0]},destroy:function(t){this.off("close",t._closeFn),t._input.off("keydown"),t._picker.destroy()},errorMessage:function(t,e){t._picker.errorMsg(e)},get:function(t){var e=t._input.val(),i=t._picker.c,n=window.moment;return e&&t.wireFormat&&n?n(e,i.format,i.momentLocale,i.momentStrict).format(t.wireFormat):e},maxDate:function(t,e){t._picker.max(e)},minDate:function(t,e){t._picker.min(e)},owns:function(t,e){return t._picker.owns(e)},set:function(t,e){var i=t._picker.c,n=window.moment;t._picker.val("string"==typeof e&&e&&0!==e.indexOf("--")&&t.wireFormat&&n?n(e,t.wireFormat,i.momentLocale,i.momentStrict).format(i.format):e),_triggerChange(t._input)}}),upload=$.extend(!0,{},baseFieldType,{canReturnSubmit:function(t,e){return!1},create:function(e){var i=this;return _commonUpload(i,e,function(t){upload.set.call(i,e,t[0]),i._event("postUpload",[e.name,t[0]])})},disable:function(t){t._input.find("input").prop("disabled",!0),t._enabled=!1},enable:function(t){t._input.find("input").prop("disabled",!1),t._enabled=!0},get:function(t){return t._val},set:function(t,e){t._val=e,t._input.val("");var i=t._input,n=(t.display&&(n=i.find("div.rendered"),t._val?n.html(t.display(t._val)):n.empty().append("<span>"+(t.noFileText||"No file")+"</span>")),i.find("div.clearValue button"));e&&t.clearText?(n.html(t.clearText),i.removeClass("noClear")):i.addClass("noClear"),t._input.find("input").triggerHandler("upload.editor",[t._val])}}),uploadMany=$.extend(!0,{},baseFieldType,{_showHide:function(t){t.limit&&(t._container.find("div.limitHide").css("display",t._val.length>=t.limit?"none":"block"),t._limitLeft=t.limit-t._val.length)},canReturnSubmit:function(t,e){return!1},create:function(e){var i=this,t=_commonUpload(i,e,function(t){e._val=e._val.concat(t),uploadMany.set.call(i,e,e._val),i._event("postUpload",[e.name,e._val])},!0);return t.addClass("multi").on("click","button.remove",function(t){t.stopPropagation(),e._enabled&&(t=$(this).data("idx"),e._val.splice(t,1),uploadMany.set.call(i,e,e._val))}),e._container=t},disable:function(t){t._input.find("input").prop("disabled",!0),t._enabled=!1},enable:function(t){t._input.find("input").prop("disabled",!1),t._enabled=!0},get:function(t){return t._val},set:function(i,t){if(t=t||[],!Array.isArray(t))throw new Error("Upload collections must have an array as a value");i._val=t,i._input.val("");var n,o=this,e=i._input;i.display&&(e=e.find("div.rendered").empty(),t.length?(n=$("<ul></ul>").appendTo(e),$.each(t,function(t,e){e=i.display(e,t);null!==e&&n.append("<li>"+e+' <button class="'+o.classes.form.button+' remove" data-idx="'+t+'">&times;</button></li>')})):e.append("<span>"+(i.noFileText||"No files")+"</span>")),uploadMany._showHide(i),i._input.find("input").triggerHandler("upload.editor",[i._val])}}),datatable=$.extend(!0,{},baseFieldType,{_addOptions:function(t,e,i){t=t.dt;(i=void 0===i?!1:i)||t.clear(),t.rows.add(e).draw()},_jumpToFirst:function(t){var e,i=t.dt.row({order:"applied",selected:!0}).index(),n=0;"number"==typeof i&&(e=t.dt.page.info().length,i=t.dt.rows({order:"applied"}).indexes().indexOf(i),n=0<e?Math.floor(i/e):0),t.dt.page(n).draw(!1)},create:function(a){var r=this,t=(a.optionsPair=$.extend({label:"label",value:"value"},a.optionsPair),$("<table>")),e=$("<div>").append(t),n=$('<div class="DTE_Field_Type_datatable_info">'),d=(a.footer&&$("<tfoot>").append(Array.isArray(a.footer)?$("<tr>").append($.map(a.footer,function(t){return $("<th>").html(t)})):a.footer).appendTo(t),t.addClass(datatable.tableClass).width("100%").on("init.dt",function(t,e){var e=new DataTable$3.Api(e),i=$(e.table(void 0).container());DataTable$3.select.init(e),n.append(i.find("div.dataTables_filter")).append(i.find("div.dt-buttons")).append(i.find("div.dataTables_info"))}).DataTable($.extend({buttons:[],columns:[{data:a.optionsPair.label,title:"Label"}],deferRender:!0,dom:"fiBtp",language:{paginate:{next:">",previous:"<"},search:"",searchPlaceholder:"Search"},lengthChange:!1,select:{style:a.multiple?"os":"single"}},a.config)));return this.on("open",function(){d.search()&&d.search("").draw(),d.columns.adjust()}),d.on("user-select",function(){_triggerChange($(a.dt.table().container()))}),a.editor&&(a.editor.table(d),a.editor.on("submitComplete",function(t,e,i,n){if("create"===n)for(var o=0,s=e.data;o<s.length;o++)!function(i){d.rows(function(t,e){return e===i}).select()}(s[o]);else"edit"!==n&&"remove"!==n||r._dataSource("refresh");datatable._jumpToFirst(a)})),a.dt=d,datatable._addOptions(a,a.options||[]),{input:e,side:n}},disable:function(t){t.dt.select.style("api"),t.dt.buttons().container().css("display","none")},dt:function(t){return t.dt},enable:function(t){t.dt.select.style(t.multiple?"os":"single"),t.dt.buttons().container().css("display","block")},get:function(t){var e=t.dt.rows({selected:!0}).data().pluck(t.optionsPair.value).toArray();return t.separator||!t.multiple?e.join(t.separator||","):e},set:function(t,n,e){t.multiple&&t.separator&&!Array.isArray(n)?n="string"==typeof n?n.split(t.separator):[]:Array.isArray(n)||(n=[n]);var o=dataGet(t.optionsPair.value);t.dt.rows({selected:!0}).deselect(),t.dt.rows(function(t,e,i){return-1!==n.indexOf(o(e))}).select(),datatable._jumpToFirst(t),e||_triggerChange($(t.dt.table().container()))},tableClass:"",update:function(t,e,i){datatable._addOptions(t,e,i);e=t._lastSet;void 0!==e&&datatable.set(t,e,!0),_triggerChange($(t.dt.table().container()))}}),defaults={className:"",compare:null,data:"",def:"",entityDecode:!0,fieldInfo:"",getFormatter:null,id:"",label:"",labelInfo:"",message:"",multiEditable:!0,name:null,nullDefault:!1,setFormatter:null,submit:!0,type:"text"},DataTable$2=$.fn.dataTable,Field=function(){function r(t,e,i){var n=this,o=i.internalI18n().multi,s=$.extend(!0,{},r.defaults,t);if(!Editor.fieldTypes[s.type])throw new Error("Error adding field - unknown field type "+s.type);this.s={classes:e,host:i,multiIds:[],multiValue:!1,multiValues:{},name:s.name,opts:s,processing:!1,type:Editor.fieldTypes[s.type]},s.id||(s.id="DTE_Field_"+s.name),""===s.data&&(s.data=s.name),this.valFromData=function(t){return dataGet(s.data)(t,"editor")},this.valToData=dataSet(s.data);var a=$('<div class="'+e.wrapper+" "+e.typePrefix+s.type+" "+e.namePrefix+s.name+" "+s.className+'"><label data-dte-e="label" class="'+e.label+'" for="'+Editor.safeId(s.id)+'">'+s.label+'<div data-dte-e="msg-label" class="'+e["msg-label"]+'">'+s.labelInfo+'</div></label><div data-dte-e="input" class="'+e.input+'"><div data-dte-e="input-control" class="'+e.inputControl+'"></div><div data-dte-e="multi-value" class="'+e.multiValue+'">'+o.title+'<span data-dte-e="multi-info" class="'+e.multiInfo+'">'+o.info+'</span></div><div data-dte-e="msg-multi" class="'+e.multiRestore+'">'+o.restore+'</div><div data-dte-e="msg-error" class="'+e["msg-error"]+'"></div><div data-dte-e="msg-message" class="'+e["msg-message"]+'">'+s.message+'</div><div data-dte-e="msg-info" class="'+e["msg-info"]+'">'+s.fieldInfo+'</div></div><div data-dte-e="field-processing" class="'+e.processing+'"><span></span></div></div>'),t=this._typeFn("create",s),i=null;t&&t.side&&(i=t.side,t=t.input),null!==t?el("input-control",a).prepend(t):a.css("display","none"),this.dom={container:a,fieldError:el("msg-error",a),fieldInfo:el("msg-info",a),fieldMessage:el("msg-message",a),inputControl:el("input-control",a),label:el("label",a).append(i),labelInfo:el("msg-label",a),multi:el("multi-value",a),multiInfo:el("multi-info",a),multiReturn:el("msg-multi",a),processing:el("field-processing",a)},this.dom.multi.on("click",function(){n.s.opts.multiEditable&&!a.hasClass(e.disabled)&&"readonly"!==s.type&&(n.val(""),n.focus())}),this.dom.multiReturn.on("click",function(){n.multiRestore()}),$.each(this.s.type,function(e,t){"function"==typeof t&&void 0===n[e]&&(n[e]=function(){var t=Array.prototype.slice.call(arguments),t=(t.unshift(e),n._typeFn.apply(n,t));return void 0===t?n:t})})}return r.prototype.def=function(t){var e,i=this.s.opts;return void 0===t?"function"==typeof(e=void 0!==i.default?i.default:i.def)?e():e:(i.def=t,this)},r.prototype.disable=function(){return this.dom.container.addClass(this.s.classes.disabled),this._typeFn("disable"),this},r.prototype.displayed=function(){var t=this.dom.container;return!(!t.parents("body").length||"none"===t.css("display"))},r.prototype.enable=function(t){return!1===(t=void 0===t?!0:t)?this.disable():(this.dom.container.removeClass(this.s.classes.disabled),this._typeFn("enable"),this)},r.prototype.enabled=function(){return!1===this.dom.container.hasClass(this.s.classes.disabled)},r.prototype.error=function(t,e){var i=this.s.classes;return t?this.dom.container.addClass(i.error):this.dom.container.removeClass(i.error),this._typeFn("errorMessage",t),this._msg(this.dom.fieldError,t,e)},r.prototype.fieldInfo=function(t){return this._msg(this.dom.fieldInfo,t)},r.prototype.isMultiValue=function(){return this.s.multiValue&&1!==this.s.multiIds.length},r.prototype.inError=function(){return this.dom.container.hasClass(this.s.classes.error)},r.prototype.input=function(){return this.s.type.input?this._typeFn("input"):$("input, select, textarea",this.dom.container)},r.prototype.focus=function(){return this.s.type.focus?this._typeFn("focus"):$("input, select, textarea",this.dom.container).focus(),this},r.prototype.get=function(){if(!this.isMultiValue())return this._format(this._typeFn("get"),this.s.opts.getFormatter)},r.prototype.hide=function(t){var e=this.dom.container;return void 0===t&&(t=!0),this.s.host.display()&&t&&$.fn.slideUp?e.slideUp():e.css("display","none"),this},r.prototype.label=function(t){var e=this.dom.label,i=this.dom.labelInfo.detach();return void 0===t?e.html():(e.html(t),e.append(i),this)},r.prototype.labelInfo=function(t){return this._msg(this.dom.labelInfo,t)},r.prototype.message=function(t,e){return this._msg(this.dom.fieldMessage,t,e)},r.prototype.multiGet=function(t){var e=this.s.multiValues,i=this.s.multiIds,n=this.isMultiValue();if(void 0===t)for(var o=this.val(),s={},a=0,r=i;a<r.length;a++){var d=r[a];s[d]=n?e[d]:o}else s=n?e[t]:this.val();return s},r.prototype.multiRestore=function(){this.s.multiValue=!0,this._multiValueCheck()},r.prototype.multiSet=function(t,i,e){void 0===e&&(e=!0);function n(t,e){-1===$.inArray(t,a)&&a.push(t),s[t]=o._format(e,o.s.opts.setFormatter)}var o=this,s=this.s.multiValues,a=this.s.multiIds;void 0===i&&(i=t,t=void 0);return $.isPlainObject(i)&&void 0===t?$.each(i,function(t,e){n(t,e)}):void 0===t?$.each(a,function(t,e){n(e,i)}):n(t,i),this.s.multiValue=!0,e&&this._multiValueCheck(),this},r.prototype.name=function(){return this.s.opts.name},r.prototype.node=function(){return this.dom.container[0]},r.prototype.nullDefault=function(){return this.s.opts.nullDefault},r.prototype.processing=function(t){return void 0===t?this.s.processing:(this.dom.processing.css("display",t?"block":"none"),this.s.processing=t,this.s.host.internalEvent("processing-field",[t]),this)},r.prototype.set=function(t,e){void 0===e&&(e=!0);function i(t){return"string"!=typeof t?t:t.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#163;/g,"Â£").replace(/&#39;/g,"'").replace(/&#10;/g,"\n")}this.s.multiValue=!1;var n=this.s.opts.entityDecode;if(void 0===n||!0===n)if(Array.isArray(t))for(var o=0,s=t.length;o<s;o++)t[o]=i(t[o]);else t=i(t);return!0===e?(t=this._format(t,this.s.opts.setFormatter),this._typeFn("set",t),this._multiValueCheck()):this._typeFn("set",t),this},r.prototype.show=function(t,e){return void 0===t&&(t=!0),!1===(e=void 0===e?!0:e)?this.hide(t):(e=this.dom.container,this.s.host.display()&&t&&$.fn.slideDown?e.slideDown():e.css("display",""),this)},r.prototype.update=function(t,e){return void 0===e&&(e=!1),this.s.type.update&&this._typeFn("update",t,e),this},r.prototype.val=function(t){return void 0===t?this.get():this.set(t)},r.prototype.compare=function(t,e){return(this.s.opts.compare||deepCompare)(t,e)},r.prototype.dataSrc=function(){return this.s.opts.data},r.prototype.destroy=function(){return this.dom.container.remove(),this._typeFn("destroy"),this},r.prototype.multiEditable=function(){return this.s.opts.multiEditable},r.prototype.multiIds=function(){return this.s.multiIds},r.prototype.multiInfoShown=function(t){this.dom.multiInfo.css({display:t?"block":"none"})},r.prototype.multiReset=function(){this.s.multiIds=[],this.s.multiValues={}},r.prototype.submittable=function(){return this.s.opts.submit},r.prototype._msg=function(t,e,i){var n;return void 0===e?t.html():("function"==typeof e&&(e=e(n=this.s.host,new DataTable$2.Api(n.internalSettings().table))),t.parent().is(":visible")&&$.fn.animate?(t.html(e),e?t.slideDown(i):t.slideUp(i)):(t.html(e||"").css("display",e?"block":"none"),i&&i()),this)},r.prototype._multiValueCheck=function(){var t,e,i=this.s.multiIds,n=this.s.multiValues,o=this.s.multiValue,s=this.s.opts.multiEditable,a=!1;if(i)for(var r=0;r<i.length;r++){if(e=n[i[r]],0<r&&!deepCompare(e,t)){a=!0;break}t=e}a&&o||!s&&this.isMultiValue()?(this.dom.inputControl.css({display:"none"}),this.dom.multi.css({display:"block"})):(this.dom.inputControl.css({display:"block"}),this.dom.multi.css({display:"none"}),o&&!a&&this.set(t,!1)),this.dom.multiReturn.css({display:i&&1<i.length&&a&&!o?"block":"none"});o=this.s.host.internalI18n().multi;return this.dom.multiInfo.html(s?o.info:o.noMulti),this.dom.multi.toggleClass(this.s.classes.multiNoEdit,!s),this.s.host.internalMultiInfo(),!0},r.prototype._typeFn=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];e.unshift(this.s.opts);var n=this.s.type[t];if(n)return n.apply(this.s.host,e)},r.prototype._errorNode=function(){return this.dom.fieldError},r.prototype._format=function(t,e){var i,n;return e?(Array.isArray(e)&&(n=(i=e.slice()).shift(),e=r.formatters[n].apply(this,i)),e.call(this.s.host,t,this)):t},r.defaults=defaults,r.formatters={},r}(),button={action:null,className:null,tabIndex:0,text:null},displayController={close:function(){},init:function(){},node:function(){},open:function(){}},DataTable$1=$.fn.dataTable,apiRegister=DataTable$1.Api.register;function _getInst(t){t=t.context[0];return t.oInit.editor||t._editor}function _setBasic(t,e,i,n){return void 0===(e=e||{}).buttons&&(e.buttons="_basic"),void 0===e.title&&(e.title=t.i18n[i].title),void 0===e.message&&("remove"===i?(t=t.i18n[i].confirm,e.message=1!==n?t._.replace(/%d/,n):t[1]):e.message=""),e}apiRegister("editor()",function(){return _getInst(this)}),apiRegister("row.create()",function(t){var e=_getInst(this);return e.create(_setBasic(e,t,"create")),this}),apiRegister("row().edit()",function(t){var e=_getInst(this);return e.edit(this[0][0],_setBasic(e,t,"edit")),this}),apiRegister("rows().edit()",function(t){var e=_getInst(this);return e.edit(this[0],_setBasic(e,t,"edit")),this}),apiRegister("row().delete()",function(t){var e=_getInst(this);return e.remove(this[0][0],_setBasic(e,t,"remove",1)),this}),apiRegister("rows().delete()",function(t){var e=_getInst(this);return e.remove(this[0],_setBasic(e,t,"remove",this[0].length)),this}),apiRegister("cell().edit()",function(t,e){return t?$.isPlainObject(t)&&(e=t,t="inline"):t="inline",_getInst(this)[t](this[0][0],e),this}),apiRegister("cells().edit()",function(t){return _getInst(this).bubble(this[0],t),this}),apiRegister("file()",file),apiRegister("files()",files),$(document).on("xhr.dt",function(t,e,i){"dt"===t.namespace&&i&&i.files&&$.each(i.files,function(t,e){Editor.files[t]||(Editor.files[t]={}),$.extend(Editor.files[t],e)})});var _buttons=$.fn.dataTable.ext.buttons;if($.extend(_buttons,{create:{action:function(t,e,i,n){var o=this,s=n.editor;this.processing(!0),s.one("preOpen",function(){o.processing(!1)}).create($.extend({buttons:n.formButtons,message:n.formMessage||s.i18n.create.message,nest:!0,title:n.formTitle||s.i18n.create.title},n.formOptions))},className:"buttons-create",editor:null,formButtons:{action:function(t){this.submit()},text:function(t){return t.i18n.create.submit}},formMessage:null,formOptions:{},formTitle:null,text:function(t,e,i){return t.i18n("buttons.create",i.editor.i18n.create.button)}},createInline:{action:function(t,e,i,n){n.editor.inlineCreate(n.position,n.formOptions)},className:"buttons-create",editor:null,formButtons:{action:function(t){this.submit()},text:function(t){return t.i18n.create.submit}},formOptions:{},position:"start",text:function(t,e,i){return t.i18n("buttons.create",i.editor.i18n.create.button)}},edit:{action:function(t,e,i,n){var o=this,s=n.editor,a=e.rows({selected:!0}).indexes(),r=e.columns({selected:!0}).indexes(),e=e.cells({selected:!0}).indexes(),e=r.length||e.length?{cells:e,columns:r,rows:a}:a;this.processing(!0),s.one("preOpen",function(){o.processing(!1)}).edit(e,$.extend({buttons:n.formButtons,message:n.formMessage||s.i18n.edit.message,nest:!0,title:n.formTitle||s.i18n.edit.title},n.formOptions))},className:"buttons-edit",editor:null,extend:"selected",formButtons:{action:function(t){this.submit()},text:function(t){return t.i18n.edit.submit}},formMessage:null,formOptions:{},formTitle:null,text:function(t,e,i){return t.i18n("buttons.edit",i.editor.i18n.edit.button)}},remove:{action:function(t,e,i,n){var o=this,s=n.editor;this.processing(!0),s.one("preOpen",function(){o.processing(!1)}).remove(e.rows({selected:!0}).indexes(),$.extend({buttons:n.formButtons,message:n.formMessage,nest:!0,title:n.formTitle||s.i18n.remove.title},n.formOptions))},className:"buttons-remove",editor:null,extend:"selected",formButtons:{action:function(t){this.submit()},text:function(t){return t.i18n.remove.submit}},formMessage:function(t,e){e=e.rows({selected:!0}).indexes(),t=t.i18n.remove;return("string"==typeof t.confirm?t.confirm:t.confirm[e.length]||t.confirm._).replace(/%d/g,e.length)},formOptions:{},formTitle:null,limitTo:["rows"],text:function(t,e,i){return t.i18n("buttons.remove",i.editor.i18n.remove.button)}}}),_buttons.editSingle=$.extend({},_buttons.edit),_buttons.editSingle.extend="selectedSingle",_buttons.removeSingle=$.extend({},_buttons.remove),_buttons.removeSingle.extend="selectedSingle",!DataTable||!DataTable.versionCheck||!DataTable.versionCheck("1.10.20"))throw new Error("Editor requires DataTables 1.10.20 or newer");var Editor=function(){function r(t){var n=this,o=(this.add=add,this.ajax=ajax,this.background=background,this.blur=blur,this.bubble=bubble,this.bubblePosition=bubblePosition,this.buttons=buttons,this.clear=clear,this.close=close,this.create=create,this.undependent=undependent,this.dependent=dependent,this.destroy=destroy,this.disable=disable,this.display=display,this.displayed=displayed,this.displayNode=displayNode,this.edit=edit,this.enable=enable,this.error=error$1,this.field=field,this.fields=fields,this.file=file,this.files=files,this.get=get,this.hide=hide,this.ids=ids,this.inError=inError,this.inline=inline,this.inlineCreate=inlineCreate,this.message=message,this.mode=mode,this.modifier=modifier,this.multiGet=multiGet,this.multiSet=multiSet,this.node=node,this.off=off,this.on=on,this.one=one,this.open=open,this.order=order,this.remove=remove,this.set=set,this.show=show,this.submit=submit,this.table=table,this.template=template,this.title=title,this.val=val,this._actionClass=_actionClass,this._ajax=_ajax,this._animate=_animate,this._assembleMain=_assembleMain,this._blur=_blur,this._clearDynamicInfo=_clearDynamicInfo,this._close=_close,this._closeReg=_closeReg,this._crudArgs=_crudArgs,this._dataSource=_dataSource,this._displayReorder=_displayReorder,this._edit=_edit,this._event=_event,this._eventName=_eventName,this._fieldFromNode=_fieldFromNode,this._fieldNames=_fieldNames,this._focus=_focus,this._formOptions=_formOptions,this._inline=_inline,this._optionsUpdate=_optionsUpdate,this._message=_message,this._multiInfo=_multiInfo,this._nestedClose=_nestedClose,this._nestedOpen=_nestedOpen,this._postopen=_postopen,this._preopen=_preopen,this._processing=_processing,this._noProcessing=_noProcessing,this._submit=_submit,this._submitTable=_submitTable,this._submitSuccess=_submitSuccess,this._submitError=_submitError,this._tidy=_tidy,this._weakInArray=_weakInArray,this instanceof r||alert("DataTables Editor must be initialised as a 'new' instance"),t=$.extend(!0,{},r.defaults,t),this.s=$.extend(!0,{},r.models.settings,{actionName:t.actionName,ajax:t.ajax,formOptions:t.formOptions,idSrc:t.idSrc,table:t.domTable||t.table,template:t.template?$(t.template).detach():null}),this.classes=$.extend(!0,{},r.classes),this.i18n=t.i18n,r.models.settings.unique++,this),e=this.classes,i=$('<div class="'+e.wrapper+'"><div data-dte-e="processing" class="'+e.processing.indicator+'"><span></span></div><div data-dte-e="body" class="'+e.body.wrapper+'"><div data-dte-e="body_content" class="'+e.body.content+'"></div></div><div data-dte-e="foot" class="'+e.footer.wrapper+'"><div class="'+e.footer.content+'"></div></div></div>'),s=$('<form data-dte-e="form" class="'+e.form.tag+'"><div data-dte-e="form_content" class="'+e.form.content+'"></div></form>'),a=(this.dom={body:el("body",i)[0],bodyContent:el("body_content",i)[0],buttons:$('<div data-dte-e="form_buttons" class="'+e.form.buttons+'"></div>')[0],footer:el("foot",i)[0],form:s[0],formContent:el("form_content",s)[0],formError:$('<div data-dte-e="form_error" class="'+e.form.error+'"></div>')[0],formInfo:$('<div data-dte-e="form_info" class="'+e.form.info+'"></div>')[0],header:$('<div data-dte-e="head" class="'+e.header.wrapper+'"><div class="'+e.header.content+'"></div></div>')[0],processing:el("processing",i)[0],wrapper:i[0]},$.each(t.events,function(t,i){o.on(t,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i.apply(o,t)})}),this.dom,this.s.table);if(t.fields&&this.add(t.fields),$(document).on("init.dt.dte"+this.s.unique,function(t,e,i){n.s.table&&e.nTable===$(a)[0]&&(e._editor=n)}).on("i18n.dt.dte"+this.s.unique,function(t,e){n.s.table&&e.nTable===$(a)[0]&&e.oLanguage.editor&&$.extend(!0,n.i18n,e.oLanguage.editor)}).on("xhr.dt.dte"+this.s.unique,function(t,e,i){i&&n.s.table&&e.nTable===$(a)[0]&&n._optionsUpdate(i)}),!r.display[t.display])throw new Error("Cannot find display controller "+t.display);this.s.displayController=r.display[t.display].init(this),this._event("initComplete",[]),$(document).trigger("initEditor",[this])}return r.prototype.internalEvent=function(t,e){this._event(t,e)},r.prototype.internalI18n=function(){return this.i18n},r.prototype.internalMultiInfo=function(){return this._multiInfo()},r.prototype.internalSettings=function(){return this.s},r.fieldTypes={checkbox:checkbox,datatable:datatable,datetime:datetime,hidden:hidden,password:password,radio:radio,readonly:readonly,select:select,text:text,textarea:textarea,upload:upload,uploadMany:uploadMany},r.files={},r.version="2.0.10",r.classes=classNames,r.Field=Field,r.DateTime=null,r.error=error,r.pairs=pairs,r.upload=upload$1,r.defaults=defaults$1,r.models={button:button,displayController:displayController,fieldType:fieldType,formOptions:formOptions,settings:settings},r.dataSources={dataTable:dataSource$1,html:dataSource},r.display={envelope:envelope,lightbox:self},r.safeId=function(t){return safeDomId(t,"")},r}();DataTable.Editor=Editor,$.fn.dataTable.Editor=Editor,DataTable.DateTime&&(Editor.DateTime=DataTable.DateTime),DataTable.ext.editorFields&&$.extend(Editor.fieldTypes,DataTable.ext.editorFields),DataTable.ext.editorFields=Editor.fieldTypes;export default Editor;